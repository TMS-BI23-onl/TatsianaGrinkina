Выполнить ПР3.
1) ученики (ID_ученика, ФИО, дата рождения, пол, ID_класса)
2) учителя (ID_учителя, ФИО, дата рождения, пол, стаж, ID_предмета)
3) классы (ID_класса, название класса, количество учеников, классный руководитель (fk на учителей))
4) предметы (ID_предмета, предмет, класс (просто как номер, в какой параллели ведется))
5) кабинеты (ID_кабинета, номер кабинета, этаж)
6) уроки (факт) (ID_предмета, ID_класса, ID_кабинета, ID_учителя, дата, оценка (может быть null))
Вывести средний балл учеников для каждой параллели по каждому предмету. Результаты вывести в виде транспонированной таблицы (оси - предмет и параллель).

SELECT id_предмет, [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11]
FROM 
(SELECT оценка, id_предмет, класс
    FROM уроки(факт) у JOIN предметы п ON у.id_предмет=п.id_предмет
) AS SourceTable 
 PIVOT
( 
	AVG(оценка)
	FOR класс IN ([1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11])
) AS PVT
ORDER BY класс

Проверить, повышает ли преподаватель оценки в свой день рождения (настроение-то лучше :). Вывести преподавателя, средний балл в день рождения, средний балл за остальные дни.
SELECT id_учителя, AVGBirth, AVGDAY
			CASE WHEN Day(дата_рождения_учителя) = DAY(дата_оценки)
			THEN (SELECT AVG(оценка) AS AVGBirth
			      WHERE Day(дата_рождения_учителя) = DAY(дата_оценки))
			ELSE (SELECT AVG(оценка) AS AVGDAY
			      WHERE Day(дата_рождения_учителя) != DAY(дата_оценки))
			END AS AVGResult
			FROM уроки(факт) у JOIN учителя ч ON у.id_учителя=ч.id_учителя


Определите отличие в концепциях построения AdventureWorks2017 и AdventureWorksDW2017 баз. Какая база будет работать быстрее с отчётами? Почему? 
AdventureWorks2017 нормализованная БД и AdventureWorksDW2017 денормализованная БД и будет работать быстрее с отчетами, т.к. в ней не надо делать JOIN. 
