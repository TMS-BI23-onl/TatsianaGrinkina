Больница
1.Врачи: ID врача, ФИО, должность, специализация, стаж работы, адрес, телефон.
2.Диагнозы - ID диагноза, название заболевания, id лекарства 
3.Пациенты – ID пациента, ФИО, адрес, телефон, страховой полис, паспорт.
4.Отделения: ID отделения, название отделения, заведующий (fk на id врачей), количество койкомест
5.Лекарства: ID лекарства, название, описание
6.Прием больных: ID посещения, id пациента, id диагноза, id отделения, id врача, дата обращения, дата выписки
Найти больных, которые повторно обратились в больницу c тем же диагнозом в течение одного года. 
Вывести все посещения, а для них: больного, диагноз, дату, врача.

SELECT ID посещения, п.ФИО, д.название заболевания, дата обращения, в.ФИО
FROM (
SELECT ID посещения, п.ФИО, д.название заболевания, дата обращения, в.ФИО
RANK() OVER (PARTITION BY п.ФИО, д.название заболевания  ORDER BY дата обращения) AS rn
FROM Прием больных б JOIN Пациенты п ON б.id пациента=п.ID пациента
                     JOIN Диагнозы д ON б.id диагноза=д.ID диагноза
					 JOIN Врачи в ON б.id врача=ID врача
WHERE DATEDIFF(day, дата обращения, GETDATE()) <=365
GROUP BY ID посещения, п.ФИО, д.название заболевания, дата обращения) AS table_rnk
WHERE rn=2
ORDER BY ID посещения
